ylab('Outcome')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(),
legend.title=element_blank())
Means.Graph
setwd("/Users/rachel/Box\ Sync/R\ Coursework/HW4")
MoralStudy<-read.csv("RmStudy.csv")
#Plot the means
library(ggplot2)
theme_set(theme_bw(base_size = 12, base_family = ""))
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
Means.Graph<-ggplot(data = Means.Table, aes(x = Outcome, y=Fix.Mean, group=Intent))+
geom_col(aes(group=Level, fill=Level), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('Rating')+
ylab('Outcome')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(),
legend.title=element_blank())
Means.Graph
Means.Graph<-ggplot(data = Means.Table, aes(x = Outcome, y=Fix.Mean, group=Intent))+
geom_col(aes(group=Level, fill=Level), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(),
legend.title=element_blank())
Means.Graph
Means.Graph<-ggplot(data = Means.Table, aes(x = Outcome, y=Rating, group=Intent))+
geom_col(aes(group=Level, fill=Level), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('Rating')+
ylab('Outcome')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(),
legend.title=element_blank())
Means.Graph
View(MoralStudy)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Intent, group=Rating))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
detach("package:bindrcpp", unload=TRUE)
detach("package:afex", unload=TRUE)
detach("package:datasets", unload=TRUE)
detach("package:emmeans", unload=TRUE)
detach("package:dplyr", unload=TRUE)
detach("package:ggplot2", unload=TRUE)
detach("package:graphics", unload=TRUE)
detach("package:grDevices", unload=TRUE)
detach("package:lme4", unload=TRUE)
detach("package:MASS", unload=TRUE)
detach("package:Matrix", unload=TRUE)
detach("package:methods", unload=TRUE)
detach("package:stats", unload=TRUE)
detach("package:tidyr", unload=TRUE)
detach("package:utils", unload=TRUE)
#Plot the means
library(ggplot2)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Intent, group=Rating))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
library(dplyr)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
library(emmeans)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
library("afex", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
library("nlme", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
# Run a two-way RM ANOVA
library(afex)
ANOVA.Moral<-aov_car(Rating~ Outcome*Intent + Error(SS/Outcome*Intent),
data = MoralStudy)
library(moments)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
setwd("/Users/rachel/Box\ Sync/R\ Coursework/HW4")
MoralStudy<-read.csv("RmStudy.csv")
#Plot the means
library(ggplot2)
library(dplyr)
library(emmeans)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Intent, group=Rating))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Intent))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
setwd("/Users/rachel/Box\ Sync/R\ Coursework/Class13/")
Example.Data<-read.csv("Raw Data for R.csv")
Example.Data$Amount<-factor(Example.Data$AmtOfInfo,
levels = c(1,2),
labels = c("Low", "High"))
Example.Data$Type<-factor(Example.Data$TypeOfInfo,
levels = c(1,2,3),
labels = c("Watching", "Reading", "Control"))
Example.Data
library(dplyr)
Means.Table<-Example.Data %>%
group_by(Amount,Type) %>%
summarise(N=n(),
Means=mean(Perceived_Ability),
SS=sum((Perceived_Ability-Means)^2),
SD=sd(Perceived_Ability),
SEM=SD/N^.5)
knitr::kable(Means.Table, digits = 2)
# Note remember knitr::kable makes it pretty, but you can just call `Means.Table`
library(ggplot2)
Plot.1<-ggplot(Means.Table, aes(x = Type, y = Means, group=Amount))+
geom_col(aes(group=Amount, fill=Amount), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Percieved Ability')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
View(Example.Data)
View(MoralStudy)
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(N=n(),
Means=mean(Rating),
SS=sum((Rating-Means)^2),
SD=sd(Rating),
SEM=SD/N^.5)
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Intent, group=Rating))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Rating, group = Intent))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('Rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
# Run a two-way RM ANOVA
library(afex)
Plot.1<-ggplot(Means.Table, aes(x = Outcome, y = Rating, group = Intent))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('morality')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Fixation))
Means.Table<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(Fix.Mean=mean(Rating))
Means.Lines <-ggplot(data = Means.Table, aes(x = Outcome, y=Fix.Mean, group=Intent))+
scale_y_continuous(limits=c(0,20),breaks = seq(0,20,2))+
geom_line(aes(colour = Intent), size=2)+
ylab("Fixation")+xlab("Outcome")+
theme(legend.position = "right")
Means.Lines
Means.Lines <-ggplot(data = Means.Table, aes(x = Outcome, y=Fix.Mean, group=Intent))+
scale_y_continuous(limits=c(-5,5),breaks = seq(0,20,2))+
geom_line(aes(colour = Intent), size=2)+
ylab("Fixation")+xlab("Outcome")+
theme(legend.position = "right")
Means.Lines
Means.Table2<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(N=n(),
Means=mean(Rating),
SS=sum((Rating-Means)^2),
SD=sd(Rating),
SEM=SD/N^.5)
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Rating, group = Intent))+
geom_col(aes(group=Rating, fill=Rating), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('morality')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Means.Table2<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(N=n(),
Means=mean(Rating),
SS=sum((Rating-Means)^2),
SD=sd(Rating),
SEM=SD/N^.5)
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Rating, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('morality')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
MoralStudy$Outcome<-factor(MoralStudy$Outcome,
levels = c(1,2),
labels = c("Positive","Negative"))
MoralStudy$Intent<-factor(MoralStudy$Intent,
levels = c(1,2),
labels = c("Positive","Negative"))
Means.Table2<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(N=n(),
Means=mean(Rating),
SS=sum((Rating-Means)^2),
SD=sd(Rating),
SEM=SD/N^.5)
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Rating, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('morality')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Means.Lines <-ggplot(data = Means.Table, aes(x = Outcome, y=Fix.Mean, group=Intent))+
scale_y_continuous(limits=c(-5,5),breaks = seq(0,20,2))+
geom_line(aes(colour = Intent), size=2)+
ylab("Fixation")+xlab("Outcome")+
theme(legend.position = "right")
Means.Lines
Means.Table2<-
MoralStudy %>%
group_by(Outcome,Intent) %>%
summarise(N=n(),
Means=mean(Rating),
SS=sum((Rating-Means)^2),
SD=sd(Rating),
SEM=SD/N^.5)
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Means, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('morality')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Means, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#f44141","#4286f4"))+
xlab('')+
ylab('morality rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Means, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#4286f4","#f44141"))+
xlab('')+
ylab('morality rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
# Run a two-way RM ANOVA
library(afex)
ANOVA.Moral<-aov_car(Rating~ Outcome*Intent + Error(SS/Outcome*Intent),
data = MoralStudy)
ANOVA.Moral
### SPSS-Like report
aov_car(Rating~ Outcome*Intent + Error(SS/Outcome*Intent),
data = MoralStudy, return="univariate")
### Manually Select DF Correction & $\eta_p^2$
aov_car(Rating~ Outcome*Intent + Error(SS/Outcome*Intent),
data = MoralStudy,
anova_table=list(correction = "HF", es='pes'))
### Manually Select DF Correction & $\eta_p^2$
aov_car(Rating~ Outcome*Intent + Error(SS/Outcome*Intent),
data = MoralStudy,
anova_table=list(correction = "GG", es='pes'))
### Pairwise follow up Fisher LSD
Fitted.Model<-emmeans(Model.1, ~Audience_Size)
### Follow up the interaction: we want to see that its driven by the fact that theres a huge
### difference between the Positive intent conditions, whereas there is no difference in
### the Negative intent conditions
Intent.by.Outcome<-emmeans(ANOVA.Moral,~Intent|Outcome)
test(pairs(Intent.by.Outcome), joint=TRUE)
### Pairwise follow up Fisher LSD
pairs(Intent.by.Outcome, adjust ='tukey')
### Follow up the interaction: we want to see that its driven by the fact that theres a huge
### difference between the Positive intent conditions, whereas there is no difference in
### the Negative intent conditions
Outcome.by.Intent<-emmeans(ANOVA.Moral,~Outcome|Intent)
test(pairs(Outcome.by.Intent), joint=TRUE)
### Pairwise follow up Fisher LSD
pairs(Outcome.by.Intent, adjust ='tukey')
### Pairwise follow up
pairs(Outcome.by.Intent, adjust ='none')
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Means, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#D3D3D3","#696969"))+
xlab('')+
ylab('morality rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Means, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(5, -6))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#D3D3D3","#696969"))+
xlab('')+
ylab('morality rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
Plot.1<-ggplot(Means.Table2, aes(x = Outcome, y = Means, group = Intent))+
geom_col(aes(group=Intent, fill=Intent), position=position_dodge(width=0.9))+
scale_y_continuous(expand = c(0, 0))+ # Forces plot to start at zero
geom_errorbar(aes(ymax = Means + SEM, ymin= Means - SEM),
position=position_dodge(width=0.9), width=0.25)+ #dodge separates the columns into groups
scale_fill_manual(values=c("#D3D3D3","#696969"))+
xlab('')+
ylab('morality rating')+
theme_bw()+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
axis.line=element_line(), #this makes the box outline open on top
legend.title=element_blank())
Plot.1
